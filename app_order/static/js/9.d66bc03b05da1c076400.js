webpackJsonp([9],{EEIf:function(t,e){},SmAD:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("BO1k"),r=a.n(n),i=a("6bRL"),s=a("2CGT"),o={name:"shoppingCar",components:{},data:function(){return{value:0,paramsData:{peopleNum:"",orderTime:Object(i.a)("YYYY-mm-dd HH:MM:SS",new Date),tableTypeId:"1"},productList:[],bookTime:"0",businessId:"1",cartList:[],show:!1,minDate:new Date,maxDate:new Date(2021,2,1),currentDate:new Date}},computed:{sumPrice:function(){var t=0,e=!0,a=!1,n=void 0;try{for(var i,s=r()(this.$store.state.cartList);!(e=(i=s.next()).done);e=!0){var o=i.value;t+=o.price*o.num}}catch(t){a=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw n}}return(t/100).toFixed(2)}},watch:{},methods:{goBack:function(){this.$router.go(-1)},onConfirm:function(t){this.paramsData.orderTime=Object(i.a)("YYYY-mm-dd HH:MM:SS",t),this.show=!1},onCancel:function(){this.show=!1},onChange:function(){this.paramsData.orderTime=Object(i.a)("YYYY-mm-dd HH:MM:SS",this.currentDate),this.bookTime="0"},onchange:function(){"0"===this.bookTime?this.paramsData.orderTime=Object(i.a)("YYYY-mm-dd HH:MM:SS",new Date):"1"===this.bookTime?this.paramsData.orderTime=Object(i.a)("YYYY-mm-dd HH:MM:SS",new Date((new Date).setMinutes((new Date).getMinutes()+30))):"2"===this.bookTime?this.paramsData.orderTime=Object(i.a)("YYYY-mm-dd HH:MM:SS",new Date((new Date).setHours((new Date).getHours()+1))):"3"===this.bookTime&&(this.paramsData.orderTime=Object(i.a)("YYYY-mm-dd HH:MM:SS",new Date((new Date).setHours((new Date).getHours()+2))))},add:function(t){t.num+=1,this.$store.dispatch("setCartList",t)},minus:function(t){t.num-=1,this.$store.dispatch("setCartList",t),0===this.$store.state.cartList.length&&(this.$toast("请重新选择商品！"),this.$router.go(-1))},getCartList:function(){this.businessId=this.$route.params.businessId,this.tableTypeList=this.$route.params.tableTypeList,this.cartList=this.$store.getters.getCartList},clearCartList:function(){this.$store.dispatch("clearCartList"),this.$toast("请重新选择商品！"),this.$router.go(-1)},pay:function(){var t=this;if(!this.paramsData.tableTypeId)return this.$notify("请选择餐桌类型！");if(!this.paramsData.peopleNum)return this.$notify("请输入就餐人数！");if(!this.paramsData.peopleNum)return this.$notify("请输入就餐人数！");var e=!0,a=!1,n=void 0;try{for(var i,o=r()(this.$store.state.cartList);!(e=(i=o.next()).done);e=!0){var c=i.value;this.productList.push({productId:c.productId,num:c.num})}}catch(t){a=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw n}}var l={token:this.$store.state.token.token,userId:this.$store.state.token.userId,businessId:this.businessId,tableTypeId:this.paramsData.tableTypeId,orderTime:new Date(this.paramsData.orderTime).valueOf(),peopleNum:this.paramsData.peopleNum-0,distcountAmount:"0",actuallyAmount:100*this.sumPrice,remark:this.paramsData.remark||"",productList:this.productList};Object(s.f)(l).then(function(e){e&&(t.$toast("支付成功"),t.$store.dispatch("clearCartList"),t.$router.push("/orderForm"))})}},created:function(){this.getCartList()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("van-nav-bar",{staticStyle:{"box-shadow":"0 3px 10px rgba(127, 127, 127, 0.06)"},attrs:{"left-arrow":"",title:"购物车"},on:{"click-left":t.goBack},scopedSlots:t._u([{key:"left",fn:function(){return[a("van-icon",{attrs:{name:"arrow-left",color:"#000000"}})]},proxy:!0},{key:"right",fn:function(){return[a("van-icon",{attrs:{name:"ellipsis",color:"#000000"}}),t._v(" \n      "),a("van-icon",{attrs:{name:"browsing-history-o",color:"#000000"}})]},proxy:!0}])}),t._v(" "),a("div",{staticClass:"app-body"},[a("div",{staticClass:"app-card"},t._l(t.$store.getters.getCartList,function(e,n){return a("div",{key:n},[a("van-cell",{attrs:{title:e.dishesName},scopedSlots:t._u([{key:"right-icon",fn:function(){return[0===n?a("span",{on:{click:t.clearCartList}},[a("van-icon",{attrs:{name:"delete"}}),t._v("清空购物车")],1):t._e()]},proxy:!0}],null,!0)}),t._v(" "),t._l(e.productList,function(e,n){return a("van-card",{key:n,attrs:{desc:e.describe,title:e.productName},scopedSlots:t._u([{key:"thumb",fn:function(){return[a("van-image",{attrs:{width:"100%",height:"100%","lazy-load":"",src:e.imageUrl},on:{click:function(a){return t.$router.push({name:"menuDetail",params:{item:e}})}}})]},proxy:!0},{key:"price",fn:function(){return[a("span",{staticStyle:{color:"red","font-size":"20px"}},[t._v("￥")]),t._v(t._s((e.price/100).toFixed(2))+"\n        ")]},proxy:!0},{key:"num",fn:function(){return[a("div",{staticStyle:{display:"flex","text-align":"center","align-items":"center"}},[0!==e.num?a("van-button",{staticStyle:{height:"22px"},attrs:{icon:"minus",color:"red",plain:"",type:"primary",size:"22",round:""},on:{click:function(a){return t.minus(e)}}}):t._e(),t._v(" "),0!==e.num?a("span",{staticStyle:{width:"32px"}},[t._v("\n              "+t._s(e.num)+"\n            ")]):t._e(),t._v(" "),a("van-button",{staticStyle:{height:"22px"},attrs:{icon:"plus",color:"red",disabled:10===e.num,type:"primary",size:"22",round:""},on:{click:function(a){return t.add(e)}}})],1)]},proxy:!0}],null,!0)})})],2)}),0),t._v(" "),a("div",{staticClass:"app-content"},[a("van-cell",[a("div",{staticStyle:{display:"flex"}},[a("span",[t._v("堂食")]),t._v(" "),a("van-radio-group",{staticStyle:{position:"relative",left:"70px"},model:{value:t.paramsData.tableTypeId,callback:function(e){t.$set(t.paramsData,"tableTypeId",e)},expression:"paramsData.tableTypeId"}},t._l(t.tableTypeList,function(e){return a("van-radio",{key:e.tableTypeId,attrs:{name:e.tableTypeId,"icon-size":"12px","checked-color":"#FE694C"}},[t._v("\n            "+t._s(e.tableTypeName)+" "+t._s(e.tableTypeDescribe)+"\n          ")])}),1)],1)]),t._v(" "),a("van-field",{attrs:{required:""===t.paramsData.peopleNum,type:"digit",label:"就餐人数",placeholder:"输入人数"},model:{value:t.paramsData.peopleNum,callback:function(e){t.$set(t.paramsData,"peopleNum",e)},expression:"paramsData.peopleNum"}}),t._v(" "),a("van-field",{attrs:{label:"备注",placeholder:"输入备注"},model:{value:t.paramsData.remark,callback:function(e){t.$set(t.paramsData,"remark",e)},expression:"paramsData.remark"}}),t._v(" "),a("div",{staticStyle:{display:"flex",padding:"0 16px"}},[a("div",{staticStyle:{flex:"1","font-size":"14px"}},[t._v("\n          就餐时间\n        ")]),t._v(" "),a("div",{staticStyle:{flex:"2","font-size":"20px",color:"#FE694C"},on:{click:function(e){t.show=!0}}},[t._v("\n          "+t._s(t.paramsData.orderTime)+"\n        ")])]),t._v(" "),a("van-cell",[a("van-radio-group",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{direction:"horizontal"},on:{change:function(e){return t.onchange()}},model:{value:t.bookTime,callback:function(e){t.bookTime=e},expression:"bookTime"}},[a("van-radio",{attrs:{name:"0","checked-color":"#FE694C"}},[t._v("现在")]),t._v(" "),a("van-radio",{attrs:{name:"1","checked-color":"#FE694C"}},[t._v("半小时后")]),t._v(" "),a("van-radio",{attrs:{name:"2","checked-color":"#FE694C"}},[t._v("1小时后")]),t._v(" "),a("van-radio",{attrs:{name:"3","checked-color":"#FE694C"}},[t._v("2小时后")])],1)],1),t._v(" "),a("van-tabbar",[a("van-tabbar-item",[a("div",{staticClass:"app-tabBar"},[a("div",{staticClass:"app-shoppingCar"},[t._v("\n              合计:￥"),a("span",{staticStyle:{"font-size":"24px"}},[a("b",[t._v(t._s(t.sumPrice))])])]),t._v(" "),a("div",{staticStyle:{display:"flex"}},[a("van-button",{staticClass:"app-button-left",staticStyle:{width:"calc(50% - 3px)"},attrs:{color:"rgba(255, 147, 126, 0.41)"},on:{click:t.goBack}},[a("span",{staticStyle:{color:"#FE694C"}},[t._v("继续点菜")])]),t._v(" "),a("van-button",{staticClass:"app-button-right",staticStyle:{width:"calc(50% - 2px)"},attrs:{color:"#FE694C"},on:{click:t.pay}},[a("span",{staticStyle:{color:"#FFFFFF"}},[t._v("支付")])])],1)])])],1)],1)]),t._v(" "),a("van-popup",{style:{height:"30%"},attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("van-datetime-picker",{attrs:{type:"datetime",title:"就餐时间","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.onConfirm,change:t.onChange,cancel:t.onCancel},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)},staticRenderFns:[]};var l=a("VU/8")(o,c,!1,function(t){a("EEIf")},"data-v-819135b4",null);e.default=l.exports}});
//# sourceMappingURL=9.d66bc03b05da1c076400.js.map