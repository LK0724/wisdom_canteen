webpackJsonp([4,5],{M6C8:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mvHQ"),i=n.n(r),s={name:"menuOptions",components:{},data:function(){return{current:0,scrollData:[],flag:0,list:[{name:"标题一"},{name:"标题二"},{name:"标题三"},{name:"标题四"},{name:"标题五"},{name:"标题六"},{name:"标题七"},{name:"标题八"},{name:"标题九"},{name:"标题十"}]}},computed:{},watch:{},props:{dishesList:Array,add:Function,minus:Function,go:Function},methods:{scrollToView:function(t,e){if(this.current!==e){if(this.current=e,!this.$refs.scrollContent)return;this.$refs.scrollContent.scrollTo({top:this.scrollData[e].top-90,behavior:"smooth"})}},getScrollData:function(){var t=this;this.scrollData=[];var e=this.$refs.scrollItem;e&&e.forEach(function(e){var n=JSON.parse(i()(e.getBoundingClientRect()));t.scrollData.push(n)})},handleScroll:function(t){var e=this;clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(function(){var n=t.target.scrollTop,r=e.scrollData.findIndex(function(t){return t.top>=n});e.current=r},100)}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){var t=this;0===this.flag&&(this.$nextTick(function(e){t.getScrollData(),t.$refs.scrollContent.addEventListener("scroll",t.handleScroll,!1)},300),this.flag+=1)},beforeDestroy:function(){this.$refs.scrollContent.removeEventListener("scroll",this.handleScroll,!1)},destroyed:function(){},activated:function(){}},a={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"about"},[n("ul",{staticClass:"nav"},[t._l(t.dishesList,function(e,r){return[n("li",{key:e.dishesName,class:{active:t.current===r},on:{click:function(n){return t.scrollToView(e,r)}}},[n("van-badge",{attrs:{content:0===e.num?"":e.num}},[t._v("\n            "+t._s(e.dishesName)+"\n          ")])],1)]})],2),t._v(" "),n("ul",{ref:"scrollContent",staticClass:"content"},[t._l(t.dishesList,function(e){return[n("li",{key:e.dishesName,ref:"scrollItem",refInFor:!0},[n("van-cell",{attrs:{title:e.dishesName}}),t._v(" "),t._l(e.productList,function(e,r){return n("van-card",{key:r,scopedSlots:t._u([{key:"thumb",fn:function(){return[n("van-image",{attrs:{width:"100%",height:"100%","lazy-load":"",src:e.imageUrl},on:{click:function(n){return t.go({name:"menuDetail",params:{item:e}})}}})]},proxy:!0},{key:"title",fn:function(){return[n("div",{staticStyle:{"font-size":"14px"}},[t._v("\n            "+t._s(e.productName)+"\n          ")])]},proxy:!0},{key:"desc",fn:function(){return[n("div",{staticStyle:{color:"#BBBBBB","font-size":"10px"}},[t._v("\n            "+t._s(e.describe)+"\n          ")])]},proxy:!0},{key:"tags",fn:function(){return[n("div",{staticStyle:{color:"#BBBBBB","font-size":"10px"}},[t._v("\n            月售："+t._s(e.saleNum)+"\n          ")])]},proxy:!0},{key:"price",fn:function(){return[n("span",{staticStyle:{color:"red","font-size":"20px"}},[t._v("￥"+t._s(e.price/100))])]},proxy:!0},{key:"num",fn:function(){return[n("div",{staticStyle:{display:"flex","text-align":"center","align-items":"center"}},[0!==e.num?n("van-button",{staticStyle:{height:"22px"},attrs:{icon:"minus",color:"red",plain:"",type:"primary",size:"22",round:""},on:{click:function(n){return t.minus(e)}}}):t._e(),t._v(" "),0!==e.num?n("span",{staticStyle:{width:"32px"}},[t._v("\n                      "+t._s(e.num)+"\n                    ")]):t._e(),t._v(" "),n("van-button",{staticStyle:{height:"22px"},attrs:{icon:"plus",color:"red",disabled:10===e.num,type:"primary",size:"22",round:""},on:{click:function(n){return t.add(e)}}})],1)]},proxy:!0}],null,!0)})})],2)]})],2)])},staticRenderFns:[]};var o=n("VU/8")(s,a,!1,function(t){n("OLMv")},"data-v-d27199f4",null);e.default=o.exports},OLMv:function(t,e){},PUWg:function(t,e){},YcmB:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("BO1k"),i=n.n(r),s=n("2CGT"),a={name:"menus",components:{menuOptions:n("M6C8").default},data:function(){return{active:0,activeKey:"",productList:[],dishesList:[],tableTypeList:[],current:0,scrollData:[],show:!1}},computed:{sumPrice:function(){var t=0,e=!0,n=!1,r=void 0;try{for(var s,a=i()(this.productList);!(e=(s=a.next()).done);e=!0){var o=s.value;t+=o.price*o.num}}catch(t){n=!0,r=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw r}}return t}},watch:{},methods:{onClickLeft:function(){this.$router.go(-1)},onchange:function(t){1===t?this.go({name:"book",params:{tableTypeList:this.tableTypeList,businessId:this.$route.query.businessId}}):2===t&&this.go("/merchant")},go:function(t){t&&this.$router.push(t)},add:function(t){t.num+=1,this.$store.dispatch("setCartList",t);var e=!0,n=!1,r=void 0;try{for(var s,a=i()(this.dishesList);!(e=(s=a.next()).done);e=!0){var o=s.value;if(0===this.$store.getters.getCartList.length)o.num=0;else{var c=!0,l=!1,u=void 0;try{for(var d,f=i()(this.$store.getters.getCartList);!(c=(d=f.next()).done);c=!0){var v=d.value;if(o.dishesName===v.dishesName){o.num=v.productList.length;break}o.num=0}}catch(t){l=!0,u=t}finally{try{!c&&f.return&&f.return()}finally{if(l)throw u}}}}}catch(t){n=!0,r=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw r}}},minus:function(t){t.num-=1,this.$store.dispatch("setCartList",t);var e=!0,n=!1,r=void 0;try{for(var s,a=i()(this.dishesList);!(e=(s=a.next()).done);e=!0){var o=s.value;if(0===this.$store.getters.getCartList.length)o.num=0;else{var c=!0,l=!1,u=void 0;try{for(var d,f=i()(this.$store.getters.getCartList);!(c=(d=f.next()).done);c=!0){var v=d.value;if(o.dishesName===v.dishesName){o.num=v.productList.length;break}o.num=0}}catch(t){l=!0,u=t}finally{try{!c&&f.return&&f.return()}finally{if(l)throw u}}}}}catch(t){n=!0,r=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw r}}},clearCartList:function(){this.$store.dispatch("clearCartList"),this.show=!1,this.getProductList(this.$route.query.businessId)},onSubmit:function(){this.$router.push({name:"shoppingCar",params:{tableTypeList:this.tableTypeList,businessId:this.$route.query.businessId}})},getProductList:function(t){var e=this,n={token:this.$store.state.token,businessId:t-0};Object(s.i)(n).then(function(t){var n=!0,r=!1,s=void 0;try{for(var a,o=i()(t.data.productList);!(n=(a=o.next()).done);n=!0){var c=a.value;if(e.$store.state.cartList.length>0){var l=!0,u=!1,d=void 0;try{for(var f,v=i()(e.$store.state.cartList);!(l=(f=v.next()).done);l=!0){var h=f.value;if(c.productId===h.productId){c.num=h.num;break}c.num=0}}catch(t){u=!0,d=t}finally{try{!l&&v.return&&v.return()}finally{if(u)throw d}}}else c.num=0}}catch(t){r=!0,s=t}finally{try{!n&&o.return&&o.return()}finally{if(r)throw s}}var p=!0,y=!1,m=void 0;try{for(var g,b=i()(t.data.dishesList);!(p=(g=b.next()).done);p=!0){var _=g.value;_.productList=[];var x=!0,L=!1,k=void 0;try{for(var C,S=i()(t.data.productList);!(x=(C=S.next()).done);x=!0){var w=C.value;_.dishesId!==w.dishesId||(_.productList.push(w),w.dishesName=_.dishesName)}}catch(t){L=!0,k=t}finally{try{!x&&S.return&&S.return()}finally{if(L)throw k}}}}catch(t){y=!0,m=t}finally{try{!p&&b.return&&b.return()}finally{if(y)throw m}}var $=!0,B=!1,N=void 0;try{for(var z,T=i()(t.data.dishesList);!($=(z=T.next()).done);$=!0){var I=z.value;if(0===e.$store.getters.getCartList.length)I.num=0;else{var O=!0,D=!1,F=void 0;try{for(var P,M=i()(e.$store.getters.getCartList);!(O=(P=M.next()).done);O=!0){var E=P.value;if(I.dishesName===E.dishesName){I.num=E.productList.length;break}I.num=0}}catch(t){D=!0,F=t}finally{try{!O&&M.return&&M.return()}finally{if(D)throw F}}}}}catch(t){B=!0,N=t}finally{try{!$&&T.return&&T.return()}finally{if(B)throw N}}e.productList=t.data.productList,e.dishesList=t.data.dishesList,e.tableTypeList=t.data.tableTypeList})}},created:function(){this.getProductList(this.$route.query.businessId)},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},o={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("van-nav-bar",{staticStyle:{"box-shadow":"0 3px 10px rgba(127, 127, 127, 0.06)"},attrs:{"left-arrow":"",title:"智慧食堂"},on:{"click-left":t.onClickLeft},scopedSlots:t._u([{key:"left",fn:function(){return[n("van-icon",{attrs:{name:"arrow-left",color:"#000000"}})]},proxy:!0},{key:"right",fn:function(){return[n("van-icon",{attrs:{name:"ellipsis",color:"#000000"}}),t._v(" \n        "),n("van-icon",{attrs:{name:"browsing-history-o",color:"#000000"}})]},proxy:!0}])}),t._v(" "),n("div",[n("van-tabs",{attrs:{"line-width":"11","line-height":"4","title-active-color":"#FE694C"},on:{change:t.onchange},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[n("van-tab",{attrs:{title:"点菜"}}),t._v(" "),n("van-tab",{attrs:{title:"餐桌预订"}}),t._v(" "),n("van-tab",{attrs:{title:"更多商家"}})],1)],1),t._v(" "),n("menuOptions",{attrs:{dishesList:t.dishesList,add:t.add,minus:t.minus,go:t.go}}),t._v(" "),n("van-tabbar",[n("van-tabbar-item",[n("div",{staticClass:"app-tabBar"},[n("div",{staticClass:"app-shoppingCar-icon",on:{click:function(e){t.show=!0}}},[n("van-badge",{attrs:{content:t.$store.state.cartList.length}},[n("van-icon",{attrs:{name:"shopping-cart",color:"white",size:"34"}})],1)],1),t._v(" "),n("div",{staticClass:"app-shoppingCar"},[t._v("\n            合计：￥"),n("b",[n("span",{staticStyle:{"font-size":"24px"}},[t._v(t._s((t.sumPrice/100).toFixed(2)))])])]),t._v(" "),n("div",[n("van-button",{staticStyle:{width:"95px",height:"49px"},attrs:{color:"#FE694C",disabled:0===t.$store.getters.getCartList.length,round:""},on:{click:t.onSubmit}},[t._v("下单")])],1)])])],1),t._v(" "),n("van-action-sheet",{staticClass:"content",attrs:{title:"购物车"},scopedSlots:t._u([{key:"description",fn:function(){return[t.$store.getters.getCartList.length>0?n("span",{on:{click:t.clearCartList}},[n("van-icon",{attrs:{name:"delete"}}),t._v("清空购物车")],1):t._e()]},proxy:!0}]),model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t._v(" "),t._l(t.$store.getters.getCartList,function(e){return n("div",{key:e.dishesName},[n("van-cell",{attrs:{title:e.dishesName}}),t._v(" "),t._l(e.productList,function(e){return n("van-card",{key:e.productId,scopedSlots:t._u([{key:"thumb",fn:function(){return[n("van-image",{attrs:{width:"100%",height:"100%","lazy-load":"",src:e.imageUrl},on:{click:function(n){return t.go({name:"menuDetail",params:{item:e}})}}})]},proxy:!0},{key:"title",fn:function(){return[n("div",{staticStyle:{"font-size":"14px"}},[t._v("\n              "+t._s(e.productName)+"\n            ")])]},proxy:!0},{key:"desc",fn:function(){return[n("div",{staticStyle:{color:"#BBBBBB","font-size":"10px"}},[t._v("\n              "+t._s(e.describe)+"\n            ")])]},proxy:!0},{key:"tags",fn:function(){return[n("div",{staticStyle:{color:"#BBBBBB","font-size":"10px"}},[t._v("\n              月售："+t._s(e.saleNum)+"\n            ")])]},proxy:!0},{key:"price",fn:function(){return[n("span",{staticStyle:{color:"red","font-size":"20px"}},[t._v("￥"+t._s(e.price/100))])]},proxy:!0},{key:"num",fn:function(){return[n("div",{staticStyle:{display:"flex","text-align":"center","align-items":"center"}},[n("van-button",{staticStyle:{height:"22px"},attrs:{icon:"minus",color:"red",disabled:0===e.num,plain:"",type:"primary",size:"22",round:""},on:{click:function(n){return t.minus(e)}}}),t._v(" "),n("span",{staticStyle:{width:"32px"}},[t._v("\n                "+t._s(e.num)+"\n              ")]),t._v(" "),n("van-button",{staticStyle:{height:"22px"},attrs:{icon:"plus",color:"red",disabled:10===e.num,type:"primary",size:"22",round:""},on:{click:function(n){return t.add(e)}}})],1)]},proxy:!0}],null,!0)})})],2)}),t._v(" "),n("van-tabbar",[n("van-tabbar-item",[n("div",{staticClass:"app-tabBar"},[n("div",{staticClass:"app-shoppingCar-icon",on:{click:function(e){t.show=!0}}},[n("van-badge",{attrs:{content:t.$store.state.cartList.length}},[n("van-icon",{attrs:{name:"shopping-cart",color:"white",size:"34"}})],1)],1),t._v(" "),n("div",{staticClass:"app-shoppingCar"},[t._v("\n              合计：￥"),n("b",[n("span",{staticStyle:{"font-size":"24px"}},[t._v(t._s((t.sumPrice/100).toFixed(2)))])])]),t._v(" "),n("div",[n("van-button",{staticStyle:{width:"95px",height:"49px"},attrs:{color:"#FE694C",disabled:0===t.$store.getters.getCartList.length,round:""},on:{click:t.onSubmit}},[t._v("下单")])],1)])])],1)],2)],1)},staticRenderFns:[]};var c=n("VU/8")(a,o,!1,function(t){n("PUWg")},"data-v-64632c31",null);e.default=c.exports},mvHQ:function(t,e,n){t.exports={default:n("qkKv"),__esModule:!0}},qkKv:function(t,e,n){var r=n("FeBl"),i=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}}});
//# sourceMappingURL=4.c08979f06cee40d4881d.js.map